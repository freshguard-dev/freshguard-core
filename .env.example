# FreshGuard Core Environment Configuration
# Security-focused environment variable template for self-hosters
#
# IMPORTANT SECURITY GUIDELINES:
# 1. NEVER commit this file with real credentials
# 2. Copy to .env and replace with your actual values
# 3. Ensure .env is in your .gitignore
# 4. Use strong passwords and proper SSL/TLS settings
# 5. Rotate credentials regularly
# 6. Use least-privilege database accounts

# ==============================================
# DATABASE CONNECTION (REQUIRED)
# ==============================================

# Primary database connection string
# SECURITY: Use SSL/TLS connections in production
# SECURITY: Use environment-specific credentials, not shared accounts
# SECURITY: Ensure database user has minimal required permissions

# PostgreSQL (Recommended for production)
FRESHGUARD_DATABASE_URL="postgresql://freshguard_user:CHANGE_THIS_PASSWORD@localhost:5432/freshguard_db?sslmode=require"

# Alternative database examples:
# DuckDB (Good for analytics/testing)
# FRESHGUARD_DATABASE_URL="duckdb://./data/freshguard.duckdb"

# BigQuery (Enterprise data warehouses)
# FRESHGUARD_DATABASE_URL="bigquery://your-project-id"

# Snowflake (Enterprise data warehouses)
# FRESHGUARD_DATABASE_URL="snowflake://your-account.snowflakecomputing.com"

# ==============================================
# CREDENTIAL SEPARATION (RECOMMENDED)
# ==============================================

# SECURITY BEST PRACTICE: Separate credentials from connection string
# This prevents credentials from appearing in logs or process lists
FRESHGUARD_DB_USER="freshguard_user"
FRESHGUARD_DB_PASSWORD="CHANGE_THIS_TO_A_STRONG_PASSWORD"

# ==============================================
# BIGQUERY SERVICE ACCOUNT (If using BigQuery)
# ==============================================

# Path to BigQuery service account JSON file
# SECURITY: Store service account file outside web-accessible directories
# SECURITY: Use least-privilege service account with only required permissions
# BIGQUERY_SERVICE_ACCOUNT_PATH="/secure/path/to/service-account.json"

# Alternative: Service account JSON as environment variable
# SECURITY: Only use this in containerized environments with proper secret management
# BIGQUERY_SERVICE_ACCOUNT_JSON='{"type":"service_account","project_id":"your-project",...}'

# ==============================================
# SSL/TLS CONFIGURATION
# ==============================================

# SSL certificate paths (for client certificates)
# SECURITY: Required for some enterprise database configurations
# SSL_CERT_PATH="/path/to/client-cert.pem"
# SSL_KEY_PATH="/path/to/client-key.pem"
# SSL_CA_PATH="/path/to/ca-cert.pem"

# ==============================================
# LOGGING AND DEBUGGING
# ==============================================

# Application environment
# SECURITY: Set to 'production' to enable error sanitization
# SECURITY: Only use 'development' for debugging, never in production
NODE_ENV="production"

# Log level (error, warn, info, debug)
# SECURITY: Use 'error' or 'warn' in production to minimize information disclosure
FRESHGUARD_LOG_LEVEL="warn"

# Enable debug logging (only in development)
# SECURITY: NEVER enable in production - may log sensitive information
# DEBUG="freshguard:*"

# ==============================================
# SECURITY CONFIGURATION
# ==============================================

# Security mode (strict, relaxed)
# SECURITY: Always use 'strict' in production
FRESHGUARD_SECURITY_MODE="strict"

# Connection timeout (milliseconds)
# SECURITY: Prevent DoS attacks with reasonable timeouts
FRESHGUARD_CONNECTION_TIMEOUT="30000"

# Query timeout (milliseconds)
# SECURITY: Prevent long-running queries from consuming resources
FRESHGUARD_QUERY_TIMEOUT="10000"

# Maximum rows returned by queries
# SECURITY: Prevent memory exhaustion from large result sets
FRESHGUARD_MAX_ROWS="1000"

# Require SSL for all database connections
# SECURITY: Always set to 'true' in production
FRESHGUARD_REQUIRE_SSL="true"

# ==============================================
# MONITORING CONFIGURATION
# ==============================================

# Default freshness tolerance (minutes)
FRESHGUARD_DEFAULT_FRESHNESS_TOLERANCE="60"

# Default volume anomaly threshold (percentage)
FRESHGUARD_DEFAULT_VOLUME_THRESHOLD="20"

# Monitoring check interval (minutes)
FRESHGUARD_CHECK_INTERVAL="15"

# ==============================================
# ALERTING CONFIGURATION (Optional)
# ==============================================

# SMTP settings for email alerts
# SECURITY: Use application-specific passwords, not your personal email password
# SMTP_HOST="smtp.gmail.com"
# SMTP_PORT="587"
# SMTP_USER="freshguard@yourcompany.com"
# SMTP_PASSWORD="APP_SPECIFIC_PASSWORD"
# SMTP_FROM="freshguard@yourcompany.com"
# SMTP_TO="alerts@yourcompany.com"

# Slack webhook for alerts
# SECURITY: Restrict webhook to specific channels
# SLACK_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"

# ==============================================
# ADVANCED SECURITY OPTIONS
# ==============================================

# API rate limiting (requests per minute)
# SECURITY: Prevent abuse of monitoring API
FRESHGUARD_RATE_LIMIT="100"

# Enable request logging
# SECURITY: Only enable for debugging, may log sensitive information
FRESHGUARD_LOG_REQUESTS="false"

# IP whitelist for CLI access (comma-separated)
# SECURITY: Restrict CLI access to specific networks
# FRESHGUARD_ALLOWED_IPS="10.0.0.0/8,172.16.0.0/12,192.168.0.0/16"

# Session timeout for CLI operations (minutes)
FRESHGUARD_SESSION_TIMEOUT="30"

# ==============================================
# DEPLOYMENT ENVIRONMENT VARIABLES
# ==============================================

# Container/Docker specific settings
# SECURITY: Use Docker secrets instead of environment variables when possible
# DOCKER_BUILDKIT="1"
# COMPOSE_DOCKER_CLI_BUILD="1"

# Kubernetes specific settings
# SECURITY: Use Kubernetes secrets and config maps
# KUBE_NAMESPACE="freshguard"
# KUBE_CONFIG_PATH="/etc/kube/config"

# ==============================================
# BACKUP AND RECOVERY
# ==============================================

# Backup storage location
# SECURITY: Use encrypted storage for backups
# BACKUP_STORAGE_PATH="/encrypted/backup/path"
# BACKUP_ENCRYPTION_KEY="CHANGE_THIS_TO_A_RANDOM_32_CHAR_KEY"

# ==============================================
# COMPLIANCE AND AUDITING
# ==============================================

# Enable audit logging
# SECURITY: Required for compliance in many industries
FRESHGUARD_AUDIT_LOG="true"

# Audit log retention (days)
FRESHGUARD_AUDIT_RETENTION="90"

# Data retention policy (days)
# SECURITY: Implement data retention policies for privacy compliance
FRESHGUARD_DATA_RETENTION="365"

# ==============================================
# SECURITY CHECKLIST FOR PRODUCTION DEPLOYMENT
# ==============================================
#
# □ Change ALL default passwords and usernames
# □ Use SSL/TLS for all database connections
# □ Set NODE_ENV to "production"
# □ Use least-privilege database accounts
# □ Enable audit logging
# □ Configure proper log rotation
# □ Set appropriate connection and query timeouts
# □ Restrict network access with firewalls
# □ Use secrets management system (not plain env files)
# □ Enable database connection pooling
# □ Set up monitoring and alerting
# □ Configure backup and recovery procedures
# □ Test disaster recovery procedures
# □ Review and rotate credentials regularly
# □ Document incident response procedures
#
# ==============================================
# EXAMPLE PRODUCTION SETUP
# ==============================================
#
# 1. Copy this file: cp .env.example .env
# 2. Generate strong passwords: openssl rand -base64 32
# 3. Create dedicated database user with minimal permissions
# 4. Configure SSL certificates for database connection
# 5. Set up log aggregation and monitoring
# 6. Configure automated backups
# 7. Test all connections: freshguard test
# 8. Start monitoring: freshguard run
#
# For more security guidance, see:
# docs/SECURITY_FOR_SELF_HOSTERS.md